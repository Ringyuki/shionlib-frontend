'use client'

import { InputNumber } from '@/components/shionui/InputNumber'
import {
  Select,
  SelectContent,
  SelectItem,
  SelectTrigger,
  SelectValue,
} from '@/components/shionui/Select'
import { useTranslations } from 'next-intl'
import {
  AdminMalwareScanCaseStatus,
  AdminMalwareScanDecisionSource,
} from '@/interfaces/admin/malware-scan.interface'

interface MalwareScanCaseListFiltersProps {
  status: AdminMalwareScanCaseStatus | undefined
  onStatusChange: (value: AdminMalwareScanCaseStatus | undefined) => void
  decisionSource: AdminMalwareScanDecisionSource | undefined
  onDecisionSourceChange: (value: AdminMalwareScanDecisionSource | undefined) => void
  fileId: number | undefined
  onFileIdChange: (value: number | undefined) => void
  resourceId: number | undefined
  onResourceIdChange: (value: number | undefined) => void
  uploaderId: number | undefined
  onUploaderIdChange: (value: number | undefined) => void
  reviewerId: number | undefined
  onReviewerIdChange: (value: number | undefined) => void
  sortBy: 'id' | 'created' | 'updated' | 'reviewed_at' | 'review_deadline'
  onSortByChange: (value: 'id' | 'created' | 'updated' | 'reviewed_at' | 'review_deadline') => void
  sortOrder: 'asc' | 'desc'
  onSortOrderChange: (value: 'asc' | 'desc') => void
}

const decisionSourceList: AdminMalwareScanDecisionSource[] = [
  'ADMIN_ALLOW',
  'ADMIN_DELETE',
  'TIMEOUT_AUTO_DELETE',
]

export function MalwareScanCaseListFilters({
  status,
  onStatusChange,
  decisionSource,
  onDecisionSourceChange,
  fileId,
  onFileIdChange,
  resourceId,
  onResourceIdChange,
  uploaderId,
  onUploaderIdChange,
  reviewerId,
  onReviewerIdChange,
  sortBy,
  onSortByChange,
  sortOrder,
  onSortOrderChange,
}: MalwareScanCaseListFiltersProps) {
  const t = useTranslations('Admin.MalwareScans')

  return (
    <div className="flex flex-wrap items-center gap-3">
      <Select
        value={status ?? 'all'}
        onValueChange={v =>
          onStatusChange(v === 'all' ? undefined : (v as AdminMalwareScanCaseStatus))
        }
      >
        <SelectTrigger className="w-[190px]">
          <SelectValue placeholder={t('status')} />
        </SelectTrigger>
        <SelectContent>
          <SelectItem value="all">{t('allStatus')}</SelectItem>
          <SelectItem value="PENDING">{t('statuses.PENDING')}</SelectItem>
          <SelectItem value="RELEASED_FALSE_POSITIVE">
            {t('statuses.RELEASED_FALSE_POSITIVE')}
          </SelectItem>
          <SelectItem value="DELETED">{t('statuses.DELETED')}</SelectItem>
        </SelectContent>
      </Select>

      <Select
        value={decisionSource ?? 'all'}
        onValueChange={v =>
          onDecisionSourceChange(v === 'all' ? undefined : (v as AdminMalwareScanDecisionSource))
        }
      >
        <SelectTrigger className="w-[220px]">
          <SelectValue placeholder={t('decisionSource')} />
        </SelectTrigger>
        <SelectContent>
          <SelectItem value="all">{t('allDecisionSources')}</SelectItem>
          {decisionSourceList.map(item => (
            <SelectItem key={item} value={item}>
              {t(`decisionSources.${item}`)}
            </SelectItem>
          ))}
        </SelectContent>
      </Select>

      <InputNumber
        className="w-[120px]"
        value={fileId ?? null}
        onChange={value => onFileIdChange(value ?? undefined)}
        placeholder={t('fileId')}
        min={1}
        clampOnBlur
        showIncrement={false}
        showDecrement={false}
      />

      <InputNumber
        className="w-[140px]"
        value={resourceId ?? null}
        onChange={value => onResourceIdChange(value ?? undefined)}
        placeholder={t('resourceId')}
        min={1}
        clampOnBlur
        showIncrement={false}
        showDecrement={false}
      />

      <InputNumber
        className="w-[130px]"
        value={uploaderId ?? null}
        onChange={value => onUploaderIdChange(value ?? undefined)}
        placeholder={t('uploaderId')}
        min={1}
        clampOnBlur
        showIncrement={false}
        showDecrement={false}
      />

      <InputNumber
        className="w-[130px]"
        value={reviewerId ?? null}
        onChange={value => onReviewerIdChange(value ?? undefined)}
        placeholder={t('reviewerId')}
        min={1}
        clampOnBlur
        showIncrement={false}
        showDecrement={false}
      />

      <Select
        value={sortBy}
        onValueChange={v =>
          onSortByChange(v as 'id' | 'created' | 'updated' | 'reviewed_at' | 'review_deadline')
        }
      >
        <SelectTrigger className="w-[170px]">
          <SelectValue placeholder={t('sortBy')} />
        </SelectTrigger>
        <SelectContent>
          <SelectItem value="id">ID</SelectItem>
          <SelectItem value="created">{t('created')}</SelectItem>
          <SelectItem value="updated">{t('updated')}</SelectItem>
          <SelectItem value="reviewed_at">{t('reviewedAt')}</SelectItem>
          <SelectItem value="review_deadline">{t('reviewDeadline')}</SelectItem>
        </SelectContent>
      </Select>

      <Select value={sortOrder} onValueChange={v => onSortOrderChange(v as 'asc' | 'desc')}>
        <SelectTrigger className="w-[100px]">
          <SelectValue />
        </SelectTrigger>
        <SelectContent>
          <SelectItem value="desc">{t('desc')}</SelectItem>
          <SelectItem value="asc">{t('asc')}</SelectItem>
        </SelectContent>
      </Select>
    </div>
  )
}
