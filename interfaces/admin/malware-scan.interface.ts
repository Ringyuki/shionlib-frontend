export type AdminMalwareScanCaseStatus = 'PENDING' | 'RELEASED_FALSE_POSITIVE' | 'DELETED'

export type AdminMalwareScanDecisionSource = 'ADMIN_ALLOW' | 'ADMIN_DELETE' | 'TIMEOUT_AUTO_DELETE'

export type AdminMalwareScanDecision = 'ALLOW' | 'DELETE'

export interface AdminMalwareScanUserSummary {
  id: number
  name: string
  avatar: string | null
}

export interface AdminMalwareScanUserDetail extends AdminMalwareScanUserSummary {
  role: number
  status: number
}

export interface AdminMalwareScanGameSummary {
  id: number
  title_jp: string | null
  title_zh: string | null
  title_en: string | null
}

export interface AdminMalwareScanCaseFileSummary {
  id: number
  file_status: number
  file_check_status: number
  is_virus_false_positive: boolean
}

export interface AdminMalwareScanCaseItem {
  id: number
  status: AdminMalwareScanCaseStatus
  decision_source: AdminMalwareScanDecisionSource | null
  review_note: string | null
  review_deadline: string
  reviewed_at: string | null
  detector: string
  detected_viruses: string[]
  file_name: string
  file_size: number
  file_hash: string
  hash_algorithm: 'sha256' | 'blake3' | null
  notify_uploader_on_allow: boolean
  uploader_notified_at: string | null
  created: string
  updated: string
  file: AdminMalwareScanCaseFileSummary | null
  resource: {
    id: number
    game_id: number
    game: AdminMalwareScanGameSummary | null
  } | null
  uploader: AdminMalwareScanUserSummary
  reviewer: AdminMalwareScanUserSummary | null
}

export interface AdminMalwareScanCaseDetail extends AdminMalwareScanCaseItem {
  scan_result: Record<string, unknown> | null
  scan_log_path: string | null
  scan_log_excerpt: string | null
  uploader: AdminMalwareScanUserDetail
}

export interface AdminMalwareScanCaseListQuery {
  page?: number
  limit?: number
  status?: AdminMalwareScanCaseStatus
  decision_source?: AdminMalwareScanDecisionSource
  file_id?: number
  resource_id?: number
  uploader_id?: number
  reviewer_id?: number
  sortBy?: 'id' | 'created' | 'updated' | 'reviewed_at' | 'review_deadline'
  sortOrder?: 'asc' | 'desc'
}
